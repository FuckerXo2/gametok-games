<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="css/keyframes.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/media.css">
    <link rel="shortcut icon" href="./favicon.ico">
    <title>2048</title>
    <style>
        /* GameTok mobile fullscreen styles */
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #faf8ef;
        }
        .container {
            width: 100%;
            max-width: 100%;
            padding: 10px;
            box-sizing: border-box;
        }
        /* Hide header and footer for cleaner mobile view */
        .heading, .game-intro, .footer {
            display: none !important;
        }
        .game-container {
            margin: 0 auto;
            margin-top: 20vh;
        }
        /* Hide game over/winning popups - app handles this */
        .failure-container, .winning-container {
            display: none !important;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="heading">
            <h1 class="title">
                <a href="">2048</a>
            </h1>
            <div class="scores-container">
                <div class="score-container">
                    <p class="title">SCORE</p>
                    <P class="score">0</P>
                    <div class="score-addition">
                        +4
                    </div>
                </div>
                <div class="best-container">
                    <p class="title">BEST</p>
                    <P class="score">66666</P>
                </div>
            </div>
        </div>
        <div class="game-intro">
            <a href="" class="restart-btn">New Game</a>
            <h2 class="subtitle">
                Play 2048 Game Online
            </h2>
            <p class="above-game">
                Join the numbers and get to the <strong>2048</strong> tile!
            </p>
        </div>
        <div class="game-container">
            <div class="grid-container">
                <div class="grid-row">
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                </div>
                <div class="grid-row">
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                </div>
                <div class="grid-row">
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                </div>
                <div class="grid-row">
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                    <div class="grid-cell"></div>
                </div>
            </div>
            <div class="tile-container">

            </div>
            <div class="failure-container pop-container">
                <p>:(</span></p>
                <p>FIALURE</p>
            </div>
            <div class="winning-container pop-container">
                <p>:)</p>
                <p>WINNING</p>
            </div>
        </div>
        <div class="footer">
            <span>
                Crafted with by
                <a href="https://gd4ark.github.io/about/">@4Ark</a>/<a href="https://github.com/gd4Ark/2048">GitHub</a>
            </span>
        </div>
    </div>
    <script src="js/config.js"></script>
    <script src="js/data.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/event.js"></script>
    <script src="js/view.js"></script>
    <script src="js/game.js"></script>
    <script>
        // GameTok integration
        var gameInstance = null;
        var viewInstance = null;
        var gameStarted = false;
        
        window.startGame = function() {
            if (gameStarted && gameInstance) {
                gameInstance.restart();
            }
            gameStarted = true;
        };
        
        // Override game over functions to report to app
        var originalFailure = Game.prototype.failure;
        Game.prototype.failure = function() {
            if (window.ReactNativeWebView) {
                window.ReactNativeWebView.postMessage(JSON.stringify({
                    type: 'gameOver',
                    score: data.score
                }));
            }
            // Don't show failure popup
        };
        
        var originalWinning = Game.prototype.winning;
        Game.prototype.winning = function() {
            if (window.ReactNativeWebView) {
                window.ReactNativeWebView.postMessage(JSON.stringify({
                    type: 'gameOver',
                    score: data.score
                }));
            }
            // Don't show winning popup
        };
        
        // Report score changes
        var originalAddScore = Game.prototype.addScore;
        Game.prototype.addScore = function(score) {
            originalAddScore.call(this, score);
            if (window.ReactNativeWebView) {
                window.ReactNativeWebView.postMessage(JSON.stringify({
                    type: 'score',
                    score: data.score
                }));
            }
        };
        
        on(window, 'load', function () {
            viewInstance = new View();
            gameInstance = new Game();
            gameInstance.init(viewInstance);
            event(gameInstance);
        });
    </script>
</body>

</html>